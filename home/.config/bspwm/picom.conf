backend = "glx";
vsync = true;
glx-use-copysubbuffer-mesa = true;
xrender-sync = true;
xrender-sync-fence = true;

# corners
rounded-corners = true;
corner-radius = 12;
detect-rounded-corners = true;

rounded-corners-exclude = [
  "class_g = 'Polybar'",
  "name = 'Polybar tray window'",
  "window_type = 'dock'",
  "window_type = 'desktop'",
  "window_type = 'notification'",
  "window_type = 'dropdown_menu'",
  "window_type = 'popup_menu'",
  "window_type = 'tooltip'",
  "class_g *?= 'dunst'",
  "_NET_WM_STATE@[*]:32a = '_NET_WM_STATE_FULLSCREEN'"
];

# Blur
blur-method = "dual_kawase";
blur-size = 13;
blur-strength = 7;
blur-background = true;
blur-background-frame = false;
blur-kern = "3x3box";

blur-background-exclude = [
  "class_g = 'Dunst'",
  "class_g = 'Polybar'",
  "name = 'Polybar tray window'",
  "window_type = 'desktop'",
  "window_type = 'dock'",
  "window_type = 'menu'",
  "window_type = 'dropdown_menu'",
  "window_type = 'popup_menu'",
  "window_type = 'tooltip'",
  "window_type = 'notification'",
  "class_g = 'firefox' && argb",
  "class_g = 'Firefox' && argb",
  "class_g = 'TelegramDesktop' && argb",
  "role = 'xborder'",
  "class_g = 'Conky'",
  "_GTK_FRAME_EXTENTS@:c"
];

# Shadows
shadow = false;

# Opacity
inactive-opacity = 0.9;
active-opacity = 0.9;

opacity-rule = [
  # Полноэкранные - 100%
  "100:_NET_WM_STATE@[0]:32a = '_NET_WM_STATE_FULLSCREEN'",
  "100:_NET_WM_STATE@[1]:32a = '_NET_WM_STATE_FULLSCREEN'",
  "100:_NET_WM_STATE@[2]:32a = '_NET_WM_STATE_FULLSCREEN'",
  "100:_NET_WM_STATE@[3]:32a = '_NET_WM_STATE_FULLSCREEN'",
  "100:_NET_WM_STATE@[4]:32a = '_NET_WM_STATE_FULLSCREEN'",
  
  # Системные окна - 100%
  "100:window_type = 'dock'",
  "100:window_type = 'desktop'",
  "100:window_type = 'notification'",
  "100:class_g = 'Polybar'",
  "100:class_g = 'Dunst'",
  "100:class_g = 'firefox'"
];

# Fading
fading = true;
fade-in-step = 0.08;
fade-out-step = 0.1;
fade-delta = 8;
no-fading-openclose = false;
no-fading-destroyed-argb = true;

# Animations - СТАРЫЙ СИНТАКСИС без rules
animations = (
    # Закрытие и скрытие окон
    {
        triggers = ["close", "hide"];
        opacity = {
            curve = "linear";
            duration = 0.15;
            start = "window-raw-opacity-before";
            end = 0;
        };
        scale-x = {
            curve = "cubic-bezier(0.3, 0, 0.8, 0.15)";
            duration = 0.15;
            start = 1;
            end = 0.8;
        };
        scale-y = "scale-x";
        offset-x = "(1 - scale-x) / 2 * window-width";
        offset-y = "(1 - scale-y) / 2 * window-height";
    },
    
    # Открытие и показ окон
    {
        triggers = ["open", "show"];
        opacity = {
            curve = "cubic-bezier(0.05, 0.9, 0.1, 1.0)";
            duration = 0.25;
            start = 0;
            end = "window-raw-opacity";
        };
        scale-x = {
            curve = "cubic-bezier(0.05, 1.1, 0.1, 1.0)";
            duration = 0.25;
            start = 0.85;
            end = 1;
        };
        scale-y = "scale-x";
        offset-x = "(1 - scale-x) / 2 * window-width";
        offset-y = "(1 - scale-y) / 2 * window-height";
    },
    
    # Изменение геометрии
    {
        triggers = ["geometry"];
        scale-x = {
            curve = "cubic-bezier(0, 0, 0, 1.2)";
            duration = 0.35;
            start = "window-width-before / window-width";
            end = 1;
        };
        scale-y = {
            curve = "cubic-bezier(0, 0, 0, 1.2)";
            duration = 0.35;
            start = "window-height-before / window-height";
            end = 1;
        };
        offset-x = {
            curve = "cubic-bezier(0, 0, 0, 1.2)";
            duration = 0.35;
            start = "window-x-before - window-x";
            end = 0;
        };
        offset-y = {
            curve = "cubic-bezier(0, 0, 0, 1.2)";
            duration = 0.35;
            start = "window-y-before - window-y";
            end = 0;
        };
    }
)
